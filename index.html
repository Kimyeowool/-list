// API 키와 재생목록 ID
const API_KEY = 'YOUR_API_KEY';  // 발급받은 API 키 입력
const PLAYLIST_IDS = [
  'PLu4x1UBAg4x_iktia7qLOURp1fOsSOz7d',  // 첫 번째 재생목록 ID
  'PLu4x1UBAg4x-3KehjcCtooRennNoUW66q',  // 두 번째 재생목록 ID
  'PLu4x1UBAg4x8lyQztvvlOEBFAxC_F3TBU'   // 세 번째 재생목록 ID
];

// 재생목록에서 랜덤으로 곡을 선택하는 함수
async function getRandomSongFromPlaylists() {
  const allVideos = [];

  // 각 재생목록에서 곡 가져오기
  for (const playlistId of PLAYLIST_IDS) {
    const response = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${playlistId}&key=${API_KEY}`);
    const data = await response.json();
    allVideos.push(...data.items);  // 여러 재생목록에서 곡들을 합침
  }

  // 랜덤으로 하나의 곡 선택
  if (allVideos.length > 0) {
    const randomVideo = allVideos[Math.floor(Math.random() * allVideos.length)];
    const title = randomVideo.snippet.title;  // 노래 제목
    const videoId = randomVideo.snippet.resourceId.videoId;  // 비디오 ID
    return { title, videoId };
  } else {
    return null;
  }
}

// 페이지에 랜덤 추천곡을 표시하는 함수
getRandomSongFromPlaylists().then(song => {
  if (song) {
    // 제목과 배경 비디오 설정
    document.getElementById('song-title').textContent = `오늘의 추천곡: ${song.title}`;
    document.getElementById('video-bg').innerHTML = `
      <iframe src="https://www.youtube.com/embed/${song.videoId}?autoplay=1&loop=1&playlist=${song.videoId}&mute=1"
        frameborder="0"
        allow="autoplay; encrypted-media"
        allowfullscreen
      ></iframe>
    `;
    document.getElementById('watchLink').href = `https://www.youtube.com/watch?v=${song.videoId}`;
  } else {
    alert('재생목록에서 노래를 불러올 수 없습니다.');
  }
});
